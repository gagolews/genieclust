<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="genieclust.cluster_validity" href="pythonapi_cluster_validity.html" /><link rel="prev" title="Python Package genieclust Reference" href="pythonapi.html" />
        <link rel="canonical" href="https://genieclust.gagolewski.com/pythonapi_root.html" />

    <link rel="shortcut icon" href="https://www.gagolewski.com/_static/img/genieclust.png"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>genieclust - Python and R Package genieclust</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=1981fb80" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: red;
  --color-brand-content: #CC3333;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --admonition-font-size: 95%;
  --admonition-title-font-size: 95%;
  --color-brand-primary: #ff2b53;
  --color-brand-content: #dd3333;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Python and R Package genieclust</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">
<div class="sidebar-logo-container">
  <a class="sidebar-brand" href="index.html"><img class="sidebar-logo" src="https://www.gagolewski.com/_static/img/genieclust.png" alt="Logo"/></a>
</div>

<span class="sidebar-brand-text">
<a class="sidebar-brand" href="index.html">genieclust</a>
</span>
<div class="sidebar-brand">
1.2.0
</div>
<form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">genieclust</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">About</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.gagolewski.com/">Author</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/genieclust">Source Code (GitHub)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/gagolews/genieclust/issues">Bug Tracker and Feature Suggestions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/genieclust">PyPI Entry</a></li>
<li class="toctree-l1"><a class="reference external" href="https://CRAN.R-project.org/package=genieclust">CRAN Entry</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples and Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="weave/basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="weave/sklearn_toy_example.html">Comparing Algorithms on Toy Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="weave/benchmarks_ar.html">Benchmarks (How Good Is It?)</a></li>
<li class="toctree-l1"><a class="reference internal" href="weave/timings.html">Timings (How Fast Is It?)</a></li>
<li class="toctree-l1"><a class="reference internal" href="weave/noise.html">Clustering with Noise Point Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="weave/r.html">R Interface Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Manual</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="pythonapi.html">Python Package <cite>genieclust</cite> Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Python Package genieclust Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">genieclust</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonapi_cluster_validity.html">genieclust.cluster_validity</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonapi_compare_partitions.html">genieclust.compare_partitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonapi_inequality.html">genieclust.inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonapi_internal.html">genieclust.internal</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonapi_plots.html">genieclust.plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="pythonapi_tools.html">genieclust.tools</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="rapi.html">R Package <em>genieclust</em> Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of R Package genieclust Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="rapi/cluster_validity.html">cluster_validity: Internal Cluster Validity Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapi/compare_partitions.html">compare_partitions: External Cluster Validity Measures and Pairwise Partition Similarity Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapi/gclust.html">gclust: Hierarchical Clustering Algorithm Genie</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapi/genieclust-package.html">genieclust-package: The Genie Hierarchical Clustering Algorithm (with Extras)</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapi/inequality.html">inequality: Inequality Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapi/mst.html">mst: Minimum Spanning Tree of the Pairwise Distance Graph</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://clustering-benchmarks.gagolewski.com/">Clustering Benchmarks</a></li>
<li class="toctree-l1"><a class="reference external" href="https://quitefastmst.gagolewski.com/">quitefastmst</a></li>
<li class="toctree-l1"><a class="reference external" href="https://datawranglingpy.gagolewski.com/">Minimalist Data Wrangling in Python</a></li>
<li class="toctree-l1"><a class="reference external" href="https://deepr.gagolewski.com/">Deep R Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="news.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="z_bibliography.html">References</a></li>
</ul>

</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/gagolews/genieclust/issues/" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto colour theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="genieclust">
<h1>genieclust<a class="headerlink" href="#genieclust" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="genieclust.MSTClusterMixin">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">genieclust.</span></span><span class="sig-name descname"><span class="pre">MSTClusterMixin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quitefastmst_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#genieclust.MSTClusterMixin" title="Link to this definition">¶</a></dt>
<dd><p>A base class for <a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a>,
<a class="reference internal" href="#genieclust.GIc" title="genieclust.GIc"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.GIc</span></code></a>, and other MST-based clustering algorithms <a class="reference internal" href="#r28d823c70776-2" id="id1">[2]</a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>n_clusters</strong><span class="classifier">int</span></dt><dd><p>The number of clusters to detect.</p>
<p>If <em>M &gt; 1</em> and <em>postprocess</em> is not <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, setting
<em>n_clusters = 1</em> makes the algorithm behave like a noise
point/outlier detector.</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>Smoothing factor for the mutual reachability distance <a class="reference internal" href="#r28d823c70776-1" id="id2">[1]</a>.
<em>M = 1</em> and <em>M = 2</em> indicate the original distance as given by
the <em>metric</em> parameter.</p>
</dd>
<dt><strong>metric</strong><span class="classifier">str</span></dt><dd><p>The metric used to compute the linkage.</p>
<p>One of:
<code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code> (synonym: <code class="docutils literal notranslate"><span class="pre">&quot;euclidean&quot;</span></code>; the default),
<code class="docutils literal notranslate"><span class="pre">&quot;l1&quot;</span></code> (synonym: <code class="docutils literal notranslate"><span class="pre">&quot;manhattan&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cityblock&quot;</span></code>),
<code class="docutils literal notranslate"><span class="pre">&quot;cosinesimil&quot;</span></code> (synonym: <code class="docutils literal notranslate"><span class="pre">&quot;cosine&quot;</span></code>), or
<code class="docutils literal notranslate"><span class="pre">&quot;precomputed&quot;</span></code>.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">&quot;precomputed&quot;</span></code>, the <em>X</em> argument to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method
must be a distance vector or a square-form distance matrix;
see <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.pdist</span></code>.</p>
<p>Determining minimum spanning trees with respect to the Euclidean
distance (the default) is much faster than with other metrics
thanks to the <a class="reference external" href="https://quitefastmst.gagolewski.com/">quitefastmst</a>
package.</p>
</dd>
<dt><strong>postprocess</strong><span class="classifier">{<code class="docutils literal notranslate"><span class="pre">&quot;boundary&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>}</span></dt><dd><p>Controls the treatment of noise/boundary points after the clusters are
identified.</p>
<p>In effect only if <cite>M</cite> &gt; 1. Each leaf in the minimum spanning tree
is treated as a <em>noise</em> point. We call it a <em>boundary point</em>
if it is amongst its adjacent vertex’s <cite>M</cite> - 1 nearest neighbours.
By default, only boundary points are merged with their nearest
<em>core</em> points.</p>
<p>To force a classical <em>n_clusters</em>-partition of a data set (with no
notion of noise), choose <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>. Furthermore, <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code> leaves
all leaves marked as noise.</p>
</dd>
<dt><strong>quitefastmst_params</strong><span class="classifier">dict</span></dt><dd><p>Additional parameters to be passed to <code class="docutils literal notranslate"><span class="pre">quitefastmst.mst_euclid</span></code>
if <code class="docutils literal notranslate"><span class="pre">metric</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code></p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>Whether to print diagnostic messages and progress information
onto <code class="docutils literal notranslate"><span class="pre">stderr</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>labels_</strong><span class="classifier">ndarray</span></dt><dd><p>Detected cluster labels.</p>
<p>Normally an integer vector such that <code class="docutils literal notranslate"><span class="pre">labels_[i]</span></code> gives
the cluster ID (between 0 and <cite>n_clusters_</cite> - 1) of the <cite>i</cite>-th object.
If <em>M &gt; 1</em>, noise/boundary points are labelled <code class="docutils literal notranslate"><span class="pre">-1</span></code>
(unless taken care of at the postprocessing stage).</p>
</dd>
<dt><strong>n_clusters_</strong><span class="classifier">int</span></dt><dd><p>The actual number of clusters detected by the algorithm.</p>
<p>It can be different from the requested one if there are too many
noise points in the dataset.</p>
</dd>
<dt><strong>n_samples_</strong><span class="classifier">int</span></dt><dd><p>The number of points in the dataset.</p>
</dd>
<dt><strong>n_features_</strong><span class="classifier">int</span></dt><dd><p>The number of features in the dataset.</p>
<p>If the information is not available, it will be set to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#genieclust.MSTClusterMixin.fit_predict" title="genieclust.MSTClusterMixin.fit_predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_predict</span></code></a>(X[, y])</p></td>
<td><p>Perform cluster analysis of a dataset and return the predicted labels.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Notes</p>
<p>If the Euclidean distance is selected, then <code class="docutils literal notranslate"><span class="pre">quitefastmst.mst_euclid</span></code> is
used to compute the MST; it is quite fast in low-dimensional spaces.
Otherwise, an implementation of the Jarník (Prim/Dijkstra)-like
<span class="math notranslate nohighlight">\(O(n^2)\)</span>-time algorithm is called.</p>
<p>If <em>M &gt; 1</em>, then the minimum spanning tree is computed with respect to the
mutual reachability distance (based, e.g., on the Euclidean metric).
Formally, the distance <span class="math notranslate nohighlight">\(d_M(i,j)\)</span> is used instead of the
chosen “raw” distance, <span class="math notranslate nohighlight">\(d(i,j)\)</span>. It holds
<span class="math notranslate nohighlight">\(d_M(i,j)=\max\{d(i,j), c_M(i), c_M(j)\}\)</span>, where the “core”
distance <span class="math notranslate nohighlight">\(c_M(i)\)</span> is given by <span class="math notranslate nohighlight">\(d(i,k)\)</span> with <span class="math notranslate nohighlight">\(k\)</span> being
the <span class="math notranslate nohighlight">\((M-1)\)</span>-th nearest neighbour of <span class="math notranslate nohighlight">\(i\)</span>. This makes “noise”
and “boundary” points being “pulled away” from each other.</p>
<p>Note that <em>M = 2</em> corresponds to the original distance.</p>
<p>The underlying clustering algorithm might leave out all MST leaves from
the clustering process. They may be merged with the nearest clusters at the
postprocessing stage, or left marked as “noise” observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Environment variables<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>OMP_NUM_THREADS</dt><dd><p>Controls the number of threads used for computing the minimum
spanning tree.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r28d823c70776-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>Campello, R.J.G.B., Moulavi, D., Sander, J.,
Density-based clustering based on hierarchical density estimates,
<em>Lecture Notes in Computer Science</em> 7819, 2013, 160-172,
doi:10.1007/978-3-642-37456-2_14.</p>
</div>
<div class="citation" id="r28d823c70776-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">2</a><span class="fn-bracket">]</span></span>
<p>Gagolewski, M., Cena, A., Bartoszuk, M., Brzozowski, L.,
Clustering with minimum spanning trees: How good can it be?,
<em>Journal of Classification</em> 42, 2025, 90-112,
doi:10.1007/s00357-024-09483-1.</p>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="genieclust.MSTClusterMixin.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#genieclust.MSTClusterMixin.fit_predict" title="Link to this definition">¶</a></dt>
<dd><p>Perform cluster analysis of a dataset and return the predicted labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">object</span></dt><dd><p>Typically a matrix with <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> rows and <code class="docutils literal notranslate"><span class="pre">n_features</span></code>
columns; see below for more details and options.</p>
</dd>
<dt><strong>y</strong><span class="classifier">None</span></dt><dd><p>Ignored.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>labels_</strong><span class="classifier">ndarray</span></dt><dd><p><cite>self.labels_</cite> attribute.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Acceptable <cite>X</cite> types are as follows.</p>
<p>For <cite>metric</cite> of <code class="docutils literal notranslate"><span class="pre">&quot;precomputed&quot;</span></code>, <cite>X</cite> should either
be a distance vector of length <code class="docutils literal notranslate"><span class="pre">n_samples*(n_samples-1)/2</span></code>
(see <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.pdist</span></code>) or a square distance matrix
of shape <code class="docutils literal notranslate"><span class="pre">(n_samples,</span> <span class="pre">n_samples)</span></code>
(see <code class="docutils literal notranslate"><span class="pre">scipy.spatial.distance.squareform</span></code>).</p>
<p>Otherwise, <cite>X</cite> should be real-valued matrix
(dense <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, or an object coercible to)
with <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> rows and <code class="docutils literal notranslate"><span class="pre">n_features</span></code> columns.</p>
<p>In the latter case, it might be a good idea to standardise
or at least somehow preprocess the coordinates of the input data
points by calling, for instance,
<code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">=</span> <span class="pre">(X-X.mean(axis=0))/X.std(axis=None,</span> <span class="pre">ddof=1)</span></code>
so that the dataset is centred at 0 and has total variance of 1.
This way the method becomes translation and scale invariant.
What’s more, if data are recorded with small precision (say, up
to few decimal digits), adding a tiny bit of Gaussian noise will
ensure the solution is unique (note that this generally applies
to other distance-based clustering algorithms as well).</p>
<p>For the clustering result, refer to the <cite>labels_</cite> and <cite>n_clusters_</cite>
attributes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="genieclust.Genie">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">genieclust.</span></span><span class="sig-name descname"><span class="pre">Genie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">gini_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_full_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_all_cuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boundary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quitefastmst_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#genieclust.Genie" title="Link to this definition">¶</a></dt>
<dd><p>Genie: Fast and Robust Hierarchical Clustering with Noise Point Detection</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>n_clusters</strong><span class="classifier">int</span></dt><dd><p>The number of clusters to detect.</p>
<p>If <em>M &gt; 1</em> and <em>postprocess</em> is not <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, setting
<em>n_clusters = 1</em> makes the algorithm behave like a noise
point/outlier detector.</p>
</dd>
<dt><strong>gini_threshold</strong><span class="classifier">float</span></dt><dd><p>The threshold for the Genie correction in [0,1].</p>
<p>The Gini index is used to quantify the inequality of the cluster
size distribution. Low thresholds highly penalise the formation
of small clusters. Threshold of 1.0 disables the correction:
in such a case, if <em>M = 1</em>, then the method is equivalent to the single
linkage algorithm.</p>
<p>The algorithm tends to be <em>stable</em> with respect to small changes
to the threshold, as they usually do not affect the output clustering.
Usually, thresholds of 0.1, 0.3, 0.5, and 0.7 are worth giving a try.</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>The smoothing factor for the mutual reachability distance <a class="reference internal" href="#r6050e59d50fb-2" id="id5">[2]</a>.
<em>M = 1</em> and <em>M = 2</em> indicate the original distance as given by
the <em>metric</em> parameter; see <a class="reference internal" href="#genieclust.MSTClusterMixin" title="genieclust.MSTClusterMixin"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin</span></code></a>
for more details.</p>
<p><em>M = 1</em> gives the original Genie algorithm <a class="reference internal" href="#r6050e59d50fb-1" id="id6">[1]</a> (with no noise/boundary
point detection) with respect to the chosen distance.</p>
</dd>
<dt><strong>metric</strong><span class="classifier">str</span></dt><dd><p>The metric used to compute the linkage; see
<a class="reference internal" href="#genieclust.MSTClusterMixin" title="genieclust.MSTClusterMixin"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin</span></code></a> for more details.
Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code>, i.e., the Euclidean distance.</p>
</dd>
<dt><strong>compute_full_tree</strong><span class="classifier">bool</span></dt><dd><p>Whether to determine the entire cluster hierarchy and the linkage matrix.</p>
<p>Only available if <em>M = 1</em>. Enables plotting dendrograms or cutting
the cluster hierarchy at an arbitrary level; see the
<em>children_</em>, <em>distances_</em>, <em>counts_</em> attributes.</p>
</dd>
<dt><strong>compute_all_cuts</strong><span class="classifier">bool</span></dt><dd><p>Whether to compute the requested <em>n_clusters</em>-partition and all
the coarser-grained ones.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the <em>labels_</em> attribute will be a matrix; see below.</p>
</dd>
<dt><strong>postprocess</strong><span class="classifier">{<code class="docutils literal notranslate"><span class="pre">&quot;boundary&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>}</span></dt><dd><p>Controls the treatment of noise/boundary points after the clusters are
identified; see <a class="reference internal" href="#genieclust.MSTClusterMixin" title="genieclust.MSTClusterMixin"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin</span></code></a> for more details.</p>
</dd>
<dt><strong>quitefastmst_params</strong><span class="classifier">dict</span></dt><dd><p>Additional parameters to be passed to <code class="docutils literal notranslate"><span class="pre">quitefastmst.mst_euclid</span></code>
if <code class="docutils literal notranslate"><span class="pre">metric</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code></p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>Whether to print diagnostic messages and progress information
onto <code class="docutils literal notranslate"><span class="pre">stderr</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>labels_</strong><span class="classifier">ndarray</span></dt><dd><p>Detected cluster labels.</p>
<p>If <cite>compute_all_cuts</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default),
it is an integer vector such that <code class="docutils literal notranslate"><span class="pre">labels_[i]</span></code> gives
the cluster ID (between 0 and <cite>n_clusters_</cite> - 1) of the <cite>i</cite>-th object.
If <em>M &gt; 1</em>, noise/boundary points are labelled <code class="docutils literal notranslate"><span class="pre">-1</span></code> (unless taken care
of at the postprocessing stage).</p>
<p>Otherwise, i.e., if <cite>compute_all_cuts</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>,
all partitions of cardinality down to <cite>n_clusters</cite>
are determined; <code class="docutils literal notranslate"><span class="pre">labels_[j,i]</span></code> denotes the cluster ID of the i-th
point in a j-partition. We assume that both the 0- and 1- partition
distinguishes only between noise- and non-noise points,
however, no postprocessing is conducted on the 0-partition
(there might be points with labels of -1 even if <cite>postprocess</cite>
is <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>).</p>
</dd>
<dt><strong>n_clusters_</strong><span class="classifier">int</span></dt><dd><p>The actual number of clusters detected by the algorithm.
It can be different from the requested one if there are too many
noise points in the dataset.</p>
</dd>
<dt><strong>n_samples_</strong><span class="classifier">int</span></dt><dd><p>The number of points in the dataset.</p>
</dd>
<dt><strong>n_features_</strong><span class="classifier">int</span></dt><dd><p>The number of features in the dataset.</p>
<p>If the information is not available, it will be set to <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
</dd>
<dt><strong>children_</strong><span class="classifier">None or ndarray</span></dt><dd><p>If <cite>compute_full_tree</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is a matrix whose
i-th row provides the information on the clusters merged in
the i-th iteration. See the description of <code class="docutils literal notranslate"><span class="pre">Z[:,0]</span></code> and <code class="docutils literal notranslate"><span class="pre">Z[:,1]</span></code>
in <code class="docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.linkage</span></code>. Together with <cite>distances_</cite> and
<cite>counts_</cite>, this constitutes the linkage matrix that can be used for
plotting the dendrogram.</p>
</dd>
<dt><strong>distances_</strong><span class="classifier">None or ndarray</span></dt><dd><p>If <cite>compute_full_tree</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is a vector that gives
the distance between two clusters merged in each iteration,
see the description of <code class="docutils literal notranslate"><span class="pre">Z[:,2]</span></code> in <code class="docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.linkage</span></code>.</p>
<p>As the original Genie algorithm does not guarantee that distances
are ordered increasingly (there are other hierarchical clustering
linkages that violate the ultrametricity property too), Genie
automatically applies the following correction:</p>
<p><code class="docutils literal notranslate"><span class="pre">distances_</span> <span class="pre">=</span> <span class="pre">genieclust.tools.cummin(distances_[::-1])[::-1]</span></code>.</p>
</dd>
<dt><strong>counts_</strong><span class="classifier">None or ndarray</span></dt><dd><p>If <cite>compute_full_tree</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is a vector giving
the number of elements in a cluster created in each iteration.
See the description of <code class="docutils literal notranslate"><span class="pre">Z[:,3]</span></code> in <code class="docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.linkage</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#genieclust.Genie.fit" title="genieclust.Genie.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X[, y])</p></td>
<td><p>Perform cluster analysis of a dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_predict</span></code>(X[, y])</p></td>
<td><p>Perform cluster analysis of a dataset and return the predicted labels.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Notes</p>
<p><strong>Genie</strong> is a robust and outlier-resistant hierarchical clustering
algorithm <a class="reference internal" href="#r6050e59d50fb-1" id="id7">[1]</a>, originally published in the R package <code class="docutils literal notranslate"><span class="pre">genie</span></code>. This new
implementation is, amongst others, much faster and now features optional
noise point detection (if <em>M &gt; 1</em>).</p>
<p>Genie is based on the minimum spanning tree (MST) of the
pairwise distance graph of a given point set (refer to
<a class="reference internal" href="#genieclust.MSTClusterMixin" title="genieclust.MSTClusterMixin"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin</span></code></a> and <a class="reference internal" href="#r6050e59d50fb-3" id="id8">[3]</a> for more details).
Just like the single linkage, it consumes the edges
of the MST in increasing order of weights. However, it prevents
the formation of clusters of highly imbalanced sizes; once the Gini index
of the cluster size distribution raises above an assumed threshold,
a forced merge of a point group of the smallest size is undertaken.
Its appealing simplicity goes hand in hand with its usability; Genie often
outperforms other clustering approaches on benchmark data.</p>
<p>The Genie algorithm itself has <span class="math notranslate nohighlight">\(O(n \sqrt{n})\)</span> time
and <span class="math notranslate nohighlight">\(O(n)\)</span> memory complexity provided that a minimum spanning
tree of the pairwise distance graph is given.
If the Euclidean distance is selected, then
<code class="docutils literal notranslate"><span class="pre">quitefastmst.mst_euclid</span></code> is used to compute the MST;
it is quite fast in low-dimensional spaces.
Otherwise, an implementation of the Jarník (Prim/Dijkstra)-like
<span class="math notranslate nohighlight">\(O(n^2)\)</span>-time algorithm is called.</p>
<p>The Genie correction together with the smoothing factor <em>M &gt; 1</em>
controlling the mutual reachability distance gives a version of the
HDBSCAN* <a class="reference internal" href="#r6050e59d50fb-2" id="id9">[2]</a> algorithm that, contrary to its predecessor, is able to
detect a <em>predefined</em> number of clusters. Hence, it is independent of
<em>DBSCAN</em>’s <code class="docutils literal notranslate"><span class="pre">eps</span></code> parameter or <em>HDBSCAN</em>’s <code class="docutils literal notranslate"><span class="pre">min_cluster_size</span></code> one.</p>
<p>Note that <em>M = 2</em> corresponds to the original distance.
If <em>M &gt; 1</em>, all MST leaves are left out from the clustering process.
They may be merged with the nearest clusters at the postprocessing stage,
or left marked as “noise” observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Environment variables<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>OMP_NUM_THREADS</dt><dd><p>Controls the number of threads used when computing the minimum
spanning tree.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r6050e59d50fb-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id6">1</a>,<a role="doc-backlink" href="#id7">2</a>)</span>
<p>Gagolewski, M., Bartoszuk, M., Cena, A.,
Genie: A new, fast, and outlier-resistant hierarchical
clustering algorithm, <em>Information Sciences</em> 363, 2016, 8-23.
doi:10.1016/j.ins.2016.05.003.</p>
</div>
<div class="citation" id="r6050e59d50fb-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id9">2</a>)</span>
<p>Campello, R.J.G.B., Moulavi, D., Sander, J.,
Density-based clustering based on hierarchical density estimates,
<em>Lecture Notes in Computer Science</em> 7819, 2013, 160-172,
doi:10.1007/978-3-642-37456-2_14.</p>
</div>
<div class="citation" id="r6050e59d50fb-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">3</a><span class="fn-bracket">]</span></span>
<p>Gagolewski, M., Cena, A., Bartoszuk, M., Brzozowski, L.,
Clustering with minimum spanning trees: How good can it be?,
<em>Journal of Classification</em> 42, 2025, 90-112,
doi:10.1007/s00357-024-09483-1.</p>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="genieclust.Genie.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#genieclust.Genie.fit" title="Link to this definition">¶</a></dt>
<dd><p>Perform cluster analysis of a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">object</span></dt><dd><p>Typically a matrix with <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> rows and <code class="docutils literal notranslate"><span class="pre">n_features</span></code>
columns; see <a class="reference internal" href="#genieclust.MSTClusterMixin.fit_predict" title="genieclust.MSTClusterMixin.fit_predict"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin.fit_predict</span></code></a> for more
details.</p>
</dd>
<dt><strong>y</strong><span class="classifier">None</span></dt><dd><p>Ignored.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">genieclust.Genie</span></dt><dd><p>The object that the method was called on.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Refer to the <cite>labels_</cite> and <cite>n_clusters_</cite> attributes for the result.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="genieclust.GIc">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">genieclust.</span></span><span class="sig-name descname"><span class="pre">GIc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">gini_thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.5,</span> <span class="pre">0.7]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_full_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_all_cuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boundary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quitefastmst_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#genieclust.GIc" title="Link to this definition">¶</a></dt>
<dd><p>GIc (Genie+Information Criterion) clustering algorithm</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>n_clusters</strong><span class="classifier">int</span></dt><dd><p>The number of clusters to detect; see <a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a>
for more details.</p>
</dd>
<dt><strong>gini_thresholds</strong><span class="classifier">array_like</span></dt><dd><p>A list of Gini’s index thresholds between 0 and 1.</p>
<p>The GIc algorithm optimises the information criterion in an
agglomerative way, starting from the intersection of the clusterings
returned by <code class="docutils literal notranslate"><span class="pre">Genie(n_clusters=n_clusters+add_clusters,</span> <span class="pre">gini_threshold=gini_thresholds[i])</span></code>,
for all <code class="docutils literal notranslate"><span class="pre">i</span></code> from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">len(gini_thresholds)-1</span></code>.</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>The smoothing factor for the mutual reachability distance; see
<a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a> for more details.</p>
</dd>
<dt><strong>metric</strong><span class="classifier">str</span></dt><dd><p>The metric used to compute the linkage; see <a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a>
for more details.</p>
</dd>
<dt><strong>compute_full_tree</strong><span class="classifier">bool</span></dt><dd><p>Whether to determine the entire cluster hierarchy and the linkage
matrix; see <a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a> for more details.</p>
</dd>
<dt><strong>compute_all_cuts</strong><span class="classifier">bool</span></dt><dd><p>Whether to compute the requested <em>n_clusters</em>-partition and all
the coarser-grained ones; see <a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a>
for more details.</p>
<p>Note that if <em>compute_all_cuts</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the <em>i</em>-th cut
in the hierarchy behaves as if <em>add_clusters</em> was equal to
<em>n_clusters-i</em>. In other words, the returned cuts might be different
from those obtained by multiple calls to GIc, each time with
different <em>n_clusters</em> and constant <em>add_clusters</em> requested.</p>
</dd>
<dt><strong>add_clusters</strong><span class="classifier">int</span></dt><dd><p>Number of additional clusters to work with internally.</p>
</dd>
<dt><strong>n_features</strong><span class="classifier">float or None</span></dt><dd><p>The dataset’s (intrinsic) dimensionality.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will be set based on the shape of the input matrix.
Yet, <em>metric</em> of <code class="docutils literal notranslate"><span class="pre">&quot;precomputed&quot;</span></code> needs this to be set manually.</p>
</dd>
<dt><strong>postprocess</strong><span class="classifier">{<code class="docutils literal notranslate"><span class="pre">&quot;boundary&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>}</span></dt><dd><p>Controls the treatment of noise/boundary points after the clusters are
identified; see <a class="reference internal" href="#genieclust.MSTClusterMixin" title="genieclust.MSTClusterMixin"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin</span></code></a> for more details.</p>
</dd>
<dt><strong>quitefastmst_params</strong><span class="classifier">dict</span></dt><dd><p>Additional parameters to be passed to <code class="docutils literal notranslate"><span class="pre">quitefastmst.mst_euclid</span></code>
if <code class="docutils literal notranslate"><span class="pre">metric</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;l2&quot;</span></code></p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>Whether to print diagnostic messages and progress information
onto <code class="docutils literal notranslate"><span class="pre">stderr</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>See :any:`genieclust.Genie`.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#genieclust.GIc.fit" title="genieclust.GIc.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X[, y])</p></td>
<td><p>Perform cluster analysis of a dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_predict</span></code>(X[, y])</p></td>
<td><p>Perform cluster analysis of a dataset and return the predicted labels.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#genieclust.Genie" title="genieclust.Genie"><code class="xref py py-obj docutils literal notranslate"><span class="pre">genieclust.Genie</span></code></a></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quitefastmst.mst_euclid</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>GIc (Genie+Information Criterion) is an Information-Theoretic
Clustering Algorithm. It was proposed by Anna Cena in <a class="reference internal" href="#r32c47d027f4e-1" id="id13">[1]</a>. It was inspired
by Mueller’s (et al.) ITM <a class="reference internal" href="#r32c47d027f4e-2" id="id14">[2]</a> and Genie <a class="reference internal" href="#r32c47d027f4e-3" id="id15">[3]</a>.</p>
<p>GIc computes an <em>n_clusters</em>-partition based on a pre-computed minimum
spanning tree (MST) of the pairwise distance graph of a given point set
(refer to <a class="reference internal" href="#genieclust.MSTClusterMixin" title="genieclust.MSTClusterMixin"><code class="xref any py py-class docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin</span></code></a> and <a class="reference internal" href="#r32c47d027f4e-4" id="id16">[4]</a> for more details).
Clusters are merged so as to maximise (heuristically)
the information criterion discussed in <a class="reference internal" href="#r32c47d027f4e-2" id="id17">[2]</a>.</p>
<p>GIc uses a bottom-up, agglomerative approach (as opposed to the ITM,
which follows a divisive scheme).  It greedily selects for merging
a pair of clusters that maximises the information criterion.
By default, the initial partition is determined by considering
the intersection of the partitions found by multiple runs of
the Genie method with thresholds [0.1, 0.3, 0.5, 0.7], which
we observe to be a sensible choice for most clustering activities.
Hence, contrary to the Genie method, we can say that GIc is virtually
parameter-free. However, when run with different <em>n_clusters</em> parameter,
it does not yield a hierarchy of nested partitions (unless some more
laborious parameter tuning is applied).</p>
<dl class="field-list simple">
<dt class="field-odd">Environment variables<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>OMP_NUM_THREADS</dt><dd><p>Controls the number of threads used when computing the minimum
spanning tree.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r32c47d027f4e-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">1</a><span class="fn-bracket">]</span></span>
<p>Cena, A., <em>Adaptive hierarchical clustering algorithms based on
data aggregation methods</em>, PhD Thesis, Systems Research Institute,
Polish Academy of Sciences 2018.</p>
</div>
<div class="citation" id="r32c47d027f4e-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id14">1</a>,<a role="doc-backlink" href="#id17">2</a>)</span>
<p>Mueller, A., Nowozin, S., Lampert, C.H., Information Theoretic
Clustering using Minimum Spanning Trees, <em>DAGM-OAGM</em>, 2012.</p>
</div>
<div class="citation" id="r32c47d027f4e-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id15">3</a><span class="fn-bracket">]</span></span>
<p>Gagolewski, M., Bartoszuk, M., Cena, A.,
Genie: A new, fast, and outlier-resistant hierarchical clustering
algorithm, <em>Information Sciences</em> 363, 2016, 8-23.
doi:10.1016/j.ins.2016.05.003.ing</p>
</div>
<div class="citation" id="r32c47d027f4e-4" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id16">4</a><span class="fn-bracket">]</span></span>
<p>Gagolewski, M., Cena, A., Bartoszuk, M., Brzozowski, L.,
Clustering with minimum spanning trees: How good can it be?,
<em>Journal of Classification</em> 42, 2025, 90-112,
doi:10.1007/s00357-024-09483-1.</p>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="genieclust.GIc.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#genieclust.GIc.fit" title="Link to this definition">¶</a></dt>
<dd><p>Perform cluster analysis of a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">object</span></dt><dd><p>Typically a matrix with <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> rows and <code class="docutils literal notranslate"><span class="pre">n_features</span></code>
columns; see <a class="reference internal" href="#genieclust.MSTClusterMixin.fit_predict" title="genieclust.MSTClusterMixin.fit_predict"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">genieclust.MSTClusterMixin.fit_predict</span></code></a> for more
details.</p>
</dd>
<dt><strong>y</strong><span class="classifier">None</span></dt><dd><p>Ignored.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">genieclust.GIc</span></dt><dd><p>The object that the method was called on.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Refer to the <cite>labels_</cite> and <cite>n_clusters_</cite> attributes for the result.</p>
<p>Note that for <cite>metric</cite> of <code class="docutils literal notranslate"><span class="pre">&quot;precomputed&quot;</span></code>, the <cite>n_features</cite>
parameter must be set explicitly.</p>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pythonapi_cluster_validity.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">genieclust.cluster_validity</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pythonapi.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Python Package <cite>genieclust</cite> Reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              
              
              Copyright &#169; 2018–2025 by <a href="https://www.gagolewski.com">Marek Gagolewski</a>.
              Some rights reserved. Licensed under <a href='https://creativecommons.org/licenses/by-nc-nd/4.0/'>CC BY-NC-ND 4.0</a>.
              Built with <a href="https://sphinx-doc.org/">Sphinx</a>
              and a customised <a href="https://github.com/pradyunsg/furo">Furo</a> theme.
              Last updated on 2025-07-24T16:19:16+0200.
              This site will never display any ads: it is a non-profit project.
              It does not collect any data.
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            In this section
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">genieclust</a><ul>
<li><a class="reference internal" href="#genieclust.MSTClusterMixin"><code class="docutils literal notranslate"><span class="pre">MSTClusterMixin</span></code></a><ul>
<li><a class="reference internal" href="#genieclust.MSTClusterMixin.fit_predict"><code class="docutils literal notranslate"><span class="pre">MSTClusterMixin.fit_predict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#genieclust.Genie"><code class="docutils literal notranslate"><span class="pre">Genie</span></code></a><ul>
<li><a class="reference internal" href="#genieclust.Genie.fit"><code class="docutils literal notranslate"><span class="pre">Genie.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#genieclust.GIc"><code class="docutils literal notranslate"><span class="pre">GIc</span></code></a><ul>
<li><a class="reference internal" href="#genieclust.GIc.fit"><code class="docutils literal notranslate"><span class="pre">GIc.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=6efca38a"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>